# Enable ES-only training (no backprop). This file is intended to be layered
# on top of `config/base.toml` via `-c config/eggroll.toml`.

mode = "eggroll"

[training]
max_iters = 5000
log_frequency = 100

[model]
# Slightly reduce dropout for ES stability; adjust as needed.
dropout = 0.05

[eggroll]
pop_size = 4096        # number of perturbations per step
rank = 4               # low-rank noise rank
sigma = 0.01           # exploration stddev
lr = 0.001             # ES learning rate
weight_decay = 0.0
max_param_norm = 5.0
seed = 12345
# All trainable matrices are targeted by default (embedding, decoder_x, decoder_y, encoder, lm_head).
# To limit to specific targets, list them here (currently informational).
targets = ["decoder_x", "decoder_y", "encoder"]
